{% extends 'base.html' %}
{% load schedule_extras %}

{% block content %}
<div class="container mt-5">
    <h2 class="text-center mb-4">ðŸ“˜ Weekly Class Schedule</h2>

    <!-- Grid View -->
    <div class="mb-5">
        <h4 class="mb-3">ðŸ“… Timetable View</h4>
        <div class="table-responsive">
            <table class="table table-bordered text-center align-middle">
                <thead class="table-light">
                    <tr>
                        <th>Time</th>
                        <th>Sunday</th>
                        <th>Monday</th>
                        <th>Tuesday</th>
                        <th>Wednesday</th>
                        <th>Thursday</th>
                        <th>Friday</th>
                        <th>Saturday</th>
                    </tr>
                </thead>
                <tbody>
                    {% for hour in hour_blocks %}
                    <tr>
                        <th scope="row">{{ hour }}</th>
                        {% for day in days %}
                        <td>
                            {% for schedule in schedule_map|get_item:day|get_item:hour %}
                            <div class="p-2 bg-info text-white rounded mb-2">
                                <strong>{{ schedule.course.code }}</strong><br>
                                {{ schedule.course.name }}<br>
                                {{ schedule.start_time|time:"H:i" }} - {{ schedule.end_time|time:"H:i" }}<br>
                                {{ schedule.course.teacher.full_name }}<br>
                                Room: {{ schedule.room_number }}
                            </div>
                            {% empty %}
                            <span class="text-muted">â€”</span>
                            {% endfor %}
                        </td>
                        {% endfor %}
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>

    <!-- List View -->
    <div>
        <h4 class="mb-3">ðŸ“„ Detailed List View</h4>
        <div class="table-responsive">
            <table class="table table-striped table-bordered align-middle">
                <thead class="table-light">
                    <tr>
                        <th>Day</th>
                        <th>Start Time</th>
                        <th>End Time</th>
                        <th>Course</th>
                        {% if user.role == 'teacher' %}
                        <th>Semester</th>
                        {% endif %}
                    </tr>
                </thead>
                <tbody>
                    {% for schedule in schedules %}
                    <tr>
                        <td>{{ schedule.day_of_week }}</td>
                        <td>{{ schedule.start_time }}</td>
                        <td>{{ schedule.end_time }}</td>
                        <td>{{ schedule.course.name }} ({{ schedule.course.code }})</td>
                        {% if user.role == 'teacher' %}
                        <td>{{ schedule.course.semester.name }}</td>
                        {% endif %}
                    </tr>
                    {% empty %}
                    <tr>
                        <td colspan="{% if user.role == 'teacher' %}5{% else %}4{% endif %}" class="text-center">
                            No schedules found.
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>
{% endblock %}
